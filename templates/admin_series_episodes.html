{% extends "base.html" %}

{% block content %}
<section style="max-width:900px; margin:0 auto;">
  <h1 style="font-size:18px; font-weight:600; margin-bottom:6px;">
    Add episode
  </h1>

  {% if series and season %}
  <p style="font-size:12px; color:var(--text-muted); margin-bottom:10px;">
    {{ series.title }} — Season {{ season.number }}
  </p>
  {% endif %}

  {% if message %}
  <div style="font-size:12px; color:#22c55e; margin-bottom:8px;">
    {{ message }}
  </div>
  {% endif %}

  <div style="font-size:11px; margin-bottom:8px;">
    <a href="/admin/series/{{ season.series_id }}/seasons"
       style="color:#38bdf8; text-decoration:none;">← Back to seasons</a>
  </div>

  <article style="background:rgba(15,23,42,0.96); border-radius:18px;
                  border:1px solid rgba(148,163,184,0.4); padding:12px 14px; margin-bottom:12px;">
    <form action="/admin/seasons/{{ season._id }}/episodes" method="post">
      <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:10px;">
        <div>
          <label style="font-size:11px; color:var(--text-muted);">Episode number</label>
          <input name="episode_number" class="admin-input" required />
        </div>
        <div>
          <label style="font-size:11px; color:var(--text-muted);">Episode title</label>
          <input name="episode_title" class="admin-input" />
        </div>
        <div>
          <label style="font-size:11px; color:var(--text-muted);">Watch link</label>
          <input name="watch_link" class="admin-input" placeholder="https://..." />
        </div>
        <div>
          <label style="font-size:11px; color:var(--text-muted);">Download link</label>
          <input name="download_link" class="admin-input" placeholder="https://..." />
        </div>
      </div>

      <div style="margin-top:8px;">
        <label style="font-size:11px; color:var(--text-muted);">Description (optional)</label>
        <textarea name="description" class="admin-textarea"
                  placeholder="Notes about this episode..."></textarea>
      </div>

      <div style="margin-top:10px; display:flex; justify-content:flex-end;">
        <button type="submit" class="admin-btn-primary">Add episode</button>
      </div>
    </form>
  </article>

  <article style="background:rgba(15,23,42,0.96); border-radius:18px;
                  border:1px solid rgba(148,163,184,0.4); padding:12px 14px;">
    <div style="font-size:13px; font-weight:600; margin-bottom:6px;">
      Episodes list
    </div>
    <table style="width:100%; border-collapse:collapse; font-size:11px;">
      <thead>
        <tr>
          <th style="text-align:left; padding:6px; color:var(--text-muted);">#</th>
          <th style="text-align:left; padding:6px; color:var(--text-muted);">Title</th>
          <th style="text-align:left; padding:6px; color:var(--text-muted);">Watch</th>
          <th style="text-align:left; padding:6px; color:var(--text-muted);">Download</th>
        </tr>
      </thead>
      <tbody>
        {% for e in episodes %}
        <tr>
          <td style="padding:6px; border-top:1px solid rgba(51,65,85,0.8);">{{ e.number }}</td>
          <td style="padding:6px; border-top:1px solid rgba(51,65,85,0.8);">{{ e.title }}</td>
          <td style="padding:6px; border-top:1px solid rgba(51,65,85,0.8);">{{ e.watch_url }}</td>
          <td style="padding:6px; border-top:1px solid rgba(51,65,85,0.8);">{{ e.download_url }}</td>
        </tr>
        {% endfor %}
        {% if episodes|length == 0 %}
        <tr>
          <td colspan="4" style="padding:6px; color:var(--text-muted);">
            No episodes added yet.
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </article>
</section>
{% endblock %}
